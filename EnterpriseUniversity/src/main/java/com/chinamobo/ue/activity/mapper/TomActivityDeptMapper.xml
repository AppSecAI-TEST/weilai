<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.chinamobo.ue.activity.dao.TomActivityDeptMapper" >
  <resultMap id="BaseResultMap" type="com.chinamobo.ue.activity.entity.TomActivityDept" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    <result column="ACTIVITY_ID" property="activityId" jdbcType="DECIMAL" />
    <result column="HEADER_CODE" property="headerCode" jdbcType="VARCHAR" />
    <result column="CODE" property="code" jdbcType="VARCHAR" />
    <result column="CREATOR" property="creator" jdbcType="VARCHAR" />
    <result column="CREATE_TIME" property="createTime" jdbcType="TIMESTAMP" />
    <result column="OPERATOR" property="operator" jdbcType="VARCHAR" />
    <result column="UPDATE_TIME" property="updateTime" jdbcType="TIMESTAMP" />
    <result column="STATUS" property="status" jdbcType="VARCHAR" />
    <result column="PUSH_STATUS" property="pushStatus" jdbcType="VARCHAR" />
  </resultMap>
  <insert id="insert" parameterType="com.chinamobo.ue.activity.entity.TomActivityDept" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    insert into TOM_ACTIVITY_DEPT (ACTIVITY_ID, HEADER_CODE, CODE, 
      CREATOR, CREATE_TIME, OPERATOR, 
      UPDATE_TIME, STATUS)
    values (#{activityId,jdbcType=DECIMAL}, #{headerCode,jdbcType=VARCHAR}, #{code,jdbcType=VARCHAR}, 
      #{creator,jdbcType=VARCHAR}, #{createTime,jdbcType=TIMESTAMP}, #{operator,jdbcType=VARCHAR}, 
      #{updateTime,jdbcType=TIMESTAMP}, #{status,jdbcType=VARCHAR})
  </insert>
  <insert id="insertSelective" parameterType="com.chinamobo.ue.activity.entity.TomActivityDept" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    insert into TOM_ACTIVITY_DEPT
    <trim prefix="(" suffix=")" suffixOverrides="," >
      <if test="activityId != null" >
        ACTIVITY_ID,
      </if>
      <if test="headerCode != null" >
        HEADER_CODE,
      </if>
      <if test="code != null" >
        CODE,
      </if>
      <if test="creator != null" >
        CREATOR,
      </if>
      <if test="createTime != null" >
        CREATE_TIME,
      </if>
      <if test="operator != null" >
        OPERATOR,
      </if>
      <if test="updateTime != null" >
        UPDATE_TIME,
      </if>
      <if test="status != null" >
        STATUS,
      </if>
      <if test="pushStatus != null" >
        PUSH_STATUS,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides="," >
      <if test="activityId != null" >
        #{activityId,jdbcType=DECIMAL},
      </if>
      <if test="headerCode != null" >
        #{headerCode,jdbcType=VARCHAR},
      </if>
      <if test="code != null" >
        #{code,jdbcType=VARCHAR},
      </if>
      <if test="creator != null" >
        #{creator,jdbcType=VARCHAR},
      </if>
      <if test="createTime != null" >
        #{createTime,jdbcType=TIMESTAMP},
      </if>
      <if test="operator != null" >
        #{operator,jdbcType=VARCHAR},
      </if>
      <if test="updateTime != null" >
        #{updateTime,jdbcType=TIMESTAMP},
      </if>
      <if test="status != null" >
        #{status,jdbcType=VARCHAR},
      </if>
      <if test="pushStatus != null" >
        #{pushStatus,jdbcType=VARCHAR},
      </if>
    </trim>
  </insert>
  
  <select id="findLeadEmp" resultType="com.chinamobo.ue.api.activity.dto.ActResults" parameterType="map">
  <!-- 培训活动负责人权限人员 -->
	      	 SELECT a.activity_id AS activityId,
				  a.admins           AS admins,
				  d.code             AS userId,
				  d.name             AS userName
				FROM TOM_ACTIVITY a
				LEFT JOIN TOM_ACTIVITY_EMPS_RELATION b
				ON a.activity_id = b.activity_id
				FULL OUTER JOIN   tom_emp d
				ON d.code            = b.code
			WHERE b.apply_status = 'Y'
			<!-- WHERE b.apply_status = 'N' TEST TODO-->
			 <if test="activityId != null" >
			 	AND  b.ACTIVITY_ID = #{activityId,jdbcType=DECIMAL}
     		 </if>
     		    
  </select>
  
    <select id="findLeadEmpFname" resultType="com.chinamobo.ue.api.activity.dto.ActResults" parameterType="map">
  <!-- 培训活动负责人权限人员 -->
	       SELECT 
			 d.CODE      AS code,
			  d.name             AS userName,
			  a.need_apply       AS needApply,
        a.activity_name      AS activityName,
        a.INTRODUCTION       AS introduction
			FROM TOM_ACTIVITY a
			LEFT JOIN TOM_ACTIVITY_EMPS_RELATION b
			ON a.activity_id = b.activity_id
			LEFT JOIN tom_emp d
			ON d.code            = b.code
			WHERE 1=1 
			<if test="activityId != null" >
			 	AND  b.ACTIVITY_ID = #{activityId,jdbcType=DECIMAL}
     		 </if>
     		 <if test="code!=null">
			AND b.CODE = #{code,jdbcType=VARCHAR}
			</if>
  </select>
  
  <!-- updateByPrimaryKeySelective -->
   <update id="updateByPrimaryKeySelective" parameterType="com.chinamobo.ue.activity.entity.TomActivityDept" >
  update tom_activity_dept
   <set >
      <if test="activityId != null" >
        ACTIVITY_ID=#{activityId,jdbcType=DECIMAL},
      </if>
      <if test="headerCode != null" >
        HEADER_CODE=#{headerCode,jdbcType=VARCHAR},
      </if>
      <if test="code != null" >
        CODE=#{code,jdbcType=VARCHAR},
      </if>
      <if test="creator != null" >
        CREATOR=#{creator,jdbcType=VARCHAR},
      </if>
      <if test="createTime != null" >
        CREATE_TIME=#{createTime,jdbcType=TIMESTAMP},
      </if>
      <if test="operator != null" >
        OPERATOR=#{operator,jdbcType=VARCHAR},
      </if>
      <if test="updateTime != null" >
        UPDATE_TIME=#{updateTime,jdbcType=TIMESTAMP},
      </if>
      <if test="status != null" >
        STATUS=#{status,jdbcType=VARCHAR},
      </if>
      <if test="pushStatus != null" >
        PUSH_STATUS=#{pushStatus,jdbcType=VARCHAR},
      </if>
    </set>
    where ACTIVITY_ID = #{activityId,jdbcType=DECIMAL} and HEADER_CODE=#{headerCode,jdbcType=VARCHAR}
   </update>
  <!-- 更改为推送状态 -->
   <update id="updateByUserActivity" parameterType="map" >
  update tom_activity_dept t set  t.push_status='Y' where t.activity_id=#{activityId,jdbcType=DECIMAL}  and t.header_code=#{userId,jdbcType=VARCHAR}
   </update>
   
   <select id="selectByActivityId" resultMap="BaseResultMap" parameterType="int">
	     select * from TOM_ACTIVITY_DEPT where ACTIVITY_ID = #{activityId,jdbcType=DECIMAL}
  </select>
  <delete id="deleteByActivityId" parameterType="java.lang.Integer" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    delete from TOM_ACTIVITY_DEPT
    where ACTIVITY_ID = #{activityId,jdbcType=DECIMAL}
  </delete>
  <select id="selectByExample" resultMap="BaseResultMap" parameterType="com.chinamobo.ue.activity.entity.TomActivityDept">
	     select * from TOM_ACTIVITY_DEPT where status='Y'
	     <if test="activityId != null" >
		 	AND  ACTIVITY_ID = #{activityId,jdbcType=DECIMAL}
   		 </if>
   		 <if test="headerCode != null" >
	         and HEADER_CODE=#{headerCode,jdbcType=VARCHAR}
	     </if>
  </select>
  
  <delete id="deleteByExample" parameterType="com.chinamobo.ue.activity.entity.TomActivityDept" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    delete from TOM_ACTIVITY_DEPT
    where ACTIVITY_ID = #{activityId,jdbcType=DECIMAL} and header_code=#{headerCode,jdbcType=VARCHAR}
  </delete>
</mapper>