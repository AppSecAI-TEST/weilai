<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.chinamobo.ue.system.dao.TomMessagesMapper" >
  <resultMap id="BaseResultMap" type="com.chinamobo.ue.system.entity.TomMessages" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    <id column="MESSAGE_ID" property="messageId" jdbcType="DECIMAL" />
    <result column="MESSAGE_TITLE" property="messageTitle" jdbcType="VARCHAR" />
    <result column="MESSAGE_TITLE_EN" property="messageTitleEn" jdbcType="VARCHAR" />
    <result column="CREATE_TIME" property="createTime" jdbcType="TIMESTAMP" />
    <result column="VIEW_COUNT" property="viewCount" jdbcType="DECIMAL" />
    <result column="MESSAGE_DETAILS" property="messageDetails" jdbcType="VARCHAR" />
    <result column="MESSAGE_DETAILS_EN" property="messageDetailsEn" jdbcType="VARCHAR" />
    <result column="MESSAGE_TYPE" property="messageType" jdbcType="VARCHAR" />
    <result column="SEND_TO_APP" property="sendToApp" jdbcType="VARCHAR" />
    <result column="SEND_TO_EMAIL" property="sendToEmail" jdbcType="VARCHAR" />
    <result column="SEND_TO_PHONE" property="sendToPhone" jdbcType="VARCHAR" />
    <result column="PC_URL" property="pcUrl" jdbcType="VARCHAR" />
    <result column="APP_URL" property="appUrl" jdbcType="VARCHAR" />
  </resultMap>
  <sql id="Base_Column_List" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    MESSAGE_ID, MESSAGE_TITLE,MESSAGE_TITLE_EN, CREATE_TIME, VIEW_COUNT, MESSAGE_DETAILS,MESSAGE_DETAILS_EN, MESSAGE_TYPE, 
    SEND_TO_APP, SEND_TO_EMAIL, SEND_TO_PHONE,PC_URL,APP_URL
  </sql>
  <!-- <sql id="MESSAGES_SEQ">MESSAGES_SEQ.nextval</sql> -->
  
  <select id="selectByPrimaryKey" resultMap="BaseResultMap" parameterType="java.lang.Integer" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    select 
    <include refid="Base_Column_List" />
    from TOM_MESSAGES
    where MESSAGE_ID = #{messageId,jdbcType=DECIMAL}
  </select>
  <delete id="deleteByPrimaryKey" parameterType="java.lang.Integer" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    delete from TOM_MESSAGES
    where MESSAGE_ID = #{messageId,jdbcType=DECIMAL}
  </delete>
  <insert id="insert" useGeneratedKeys="true" keyProperty="messageId" parameterType="com.chinamobo.ue.system.entity.TomMessages" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    insert into TOM_MESSAGES (<!-- MESSAGE_ID, --> MESSAGE_TITLE,MESSAGE_TITLE_EN, CREATE_TIME, 
      VIEW_COUNT, MESSAGE_DETAILS,MESSAGE_DETAILS_EN, MESSAGE_TYPE, 
      SEND_TO_APP, SEND_TO_EMAIL, SEND_TO_PHONE,PC_URL,APP_URL
      )
    values (<!-- #{messageId,jdbcType=DECIMAL}, --> #{messageTitle,jdbcType=VARCHAR},#{messageTitleEn,jdbcType=VARCHAR}, #{createTime,jdbcType=TIMESTAMP}, 
      #{viewCount,jdbcType=DECIMAL}, #{messageDetails,jdbcType=VARCHAR},#{messageDetailsEn,jdbcType=VARCHAR}, #{messageType,jdbcType=VARCHAR}, 
      #{sendToApp,jdbcType=VARCHAR}, #{sendToEmail,jdbcType=VARCHAR}, #{sendToPhone,jdbcType=VARCHAR}, #{pcUrl,jdbcType=VARCHAR}, #{appUrl,jdbcType=VARCHAR}
      )
  </insert>
  <insert id="insertSelective" useGeneratedKeys="true" keyProperty="messageId"  parameterType="com.chinamobo.ue.system.entity.TomMessages" >
<!-- <selectKey keyProperty="messageId" resultType="Integer" order="BEFORE">
			select
			<include refid="MESSAGES_SEQ" />
			from dual
		</selectKey> -->
    insert into TOM_MESSAGES
    <trim prefix="(" suffix=")" suffixOverrides="," >
      <!-- <if test="messageId != null" >
        MESSAGE_ID,
      </if> -->
      <if test="messageTitle != null" >
        MESSAGE_TITLE,
      </if>
      <if test="messageTitleEn != null" >
        MESSAGE_TITLE_EN,
      </if>
      <if test="createTime != null" >
        CREATE_TIME,
      </if>
      <if test="viewCount != null" >
        VIEW_COUNT,
      </if>
      <if test="messageDetails != null" >
        MESSAGE_DETAILS,
      </if>
      <if test="messageDetailsEn != null" >
        MESSAGE_DETAILS_EN,
      </if>
      <if test="messageType != null" >
        MESSAGE_TYPE,
      </if>
      <if test="sendToApp != null" >
        SEND_TO_APP,
      </if>
      <if test="sendToEmail != null" >
        SEND_TO_EMAIL,
      </if>
      <if test="sendToPhone != null" >
        SEND_TO_PHONE,
      </if>
      <if test="pcUrl != null" >
        PC_URL,
      </if>
      <if test="appUrl != null" >
        APP_URL,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides="," >
      <!-- <if test="messageId != null" >
        #{messageId,jdbcType=DECIMAL},
      </if> -->
      <if test="messageTitle != null" >
        #{messageTitle,jdbcType=VARCHAR},
      </if>
      <if test="messageTitleEn != null" >
        #{messageTitleEn,jdbcType=VARCHAR},
      </if>
      <if test="createTime != null" >
        #{createTime,jdbcType=TIMESTAMP},
      </if>
      <if test="viewCount != null" >
        #{viewCount,jdbcType=DECIMAL},
      </if>
      <if test="messageDetails != null" >
        #{messageDetails,jdbcType=VARCHAR},
      </if>
      <if test="messageDetailsEn != null" >
        #{messageDetailsEn,jdbcType=VARCHAR},
      </if>
      <if test="messageType != null" >
        #{messageType,jdbcType=VARCHAR},
      </if>
      <if test="sendToApp != null" >
        #{sendToApp,jdbcType=VARCHAR},
      </if>
      <if test="sendToEmail != null" >
        #{sendToEmail,jdbcType=VARCHAR},
      </if>
      <if test="sendToPhone != null" >
        #{sendToPhone,jdbcType=VARCHAR},
      </if>
      <if test="pcUrl != null" >
        #{pcUrl,jdbcType=VARCHAR},
      </if>
      <if test="appUrl != null" >
        #{appUrl,jdbcType=VARCHAR},
      </if>
    </trim>
  </insert>
  <update id="updateByPrimaryKeySelective" parameterType="com.chinamobo.ue.system.entity.TomMessages" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    update TOM_MESSAGES
    <set >
      <if test="messageTitle != null" >
        MESSAGE_TITLE = #{messageTitle,jdbcType=VARCHAR},
      </if>
      <if test="messageTitleEn != null" >
        MESSAGE_TITLE_EN = #{messageTitleEn,jdbcType=VARCHAR},
      </if>
      <if test="createTime != null" >
        CREATE_TIME = #{createTime,jdbcType=TIMESTAMP},
      </if>
      <if test="viewCount != null" >
        VIEW_COUNT = #{viewCount,jdbcType=DECIMAL},
      </if>
      <if test="messageDetails != null" >
        MESSAGE_DETAILS = #{messageDetails,jdbcType=VARCHAR},
      </if>
      <if test="messageDetailsEn != null" >
        MESSAGE_DETAILS_EN = #{messageDetailsEn,jdbcType=VARCHAR},
      </if>
      <if test="messageType != null" >
        MESSAGE_TYPE = #{messageType,jdbcType=VARCHAR},
      </if>
      <if test="sendToApp != null" >
        SEND_TO_APP = #{sendToApp,jdbcType=VARCHAR},
      </if>
      <if test="sendToEmail != null" >
        SEND_TO_EMAIL = #{sendToEmail,jdbcType=VARCHAR},
      </if>
      <if test="sendToPhone != null" >
        SEND_TO_PHONE = #{sendToPhone,jdbcType=VARCHAR},
      </if>
       <if test="pcUrl != null" >
        PC_URL = #{pcUrl,jdbcType=VARCHAR},
      </if>
      <if test="appUrl != null" >
        APP_URL = #{appUrl,jdbcType=VARCHAR},
      </if>
    </set>
    where MESSAGE_ID = #{messageId,jdbcType=DECIMAL}
  </update>
  <update id="updateByPrimaryKey" parameterType="com.chinamobo.ue.system.entity.TomMessages" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    update TOM_MESSAGES
    set MESSAGE_TITLE = #{messageTitle,jdbcType=VARCHAR},
      MESSAGE_TITLE_EN = #{messageTitleEn,jdbcType=VARCHAR},
      CREATE_TIME = #{createTime,jdbcType=TIMESTAMP},
      VIEW_COUNT = #{viewCount,jdbcType=DECIMAL},
      MESSAGE_DETAILS = #{messageDetails,jdbcType=VARCHAR},
      MESSAGE_DETAILS_EN = #{messageDetailsEn,jdbcType=VARCHAR},
      MESSAGE_TYPE = #{messageType,jdbcType=VARCHAR},
      SEND_TO_APP = #{sendToApp,jdbcType=VARCHAR},
      SEND_TO_EMAIL = #{sendToEmail,jdbcType=VARCHAR},
      SEND_TO_PHONE = #{sendToPhone,jdbcType=VARCHAR},
       PC_URL = #{pcUrl,jdbcType=VARCHAR},
       APP_URL = #{appUrl,jdbcType=VARCHAR}
    where MESSAGE_ID = #{messageId,jdbcType=DECIMAL}
  </update>
  <!-- 查询员工所有消息 -->
  <select id="selectByCode" resultType="com.chinamobo.ue.api.message.dto.MessageDto" parameterType="map" >
    select t.message_id as messageId,t.message_title as messageTitle,t.message_title_en as messageTitleEn,t.create_time as createTime,t.message_details as messageDetails,t.message_details_en as messageDetailsEn,t.pc_url as pcUrl,t.app_url as appUrl,t.message_type as messageType,te.is_view as isView from TOM_MESSAGES t,tom_message_employees te
    where t.message_id=te.message_id and te.emp_code=#{code,jdbcType=DECIMAL} and (t.SEND_TO_APP='Y' or t.SEND_TO_EMAIL='Y' or  t.SEND_TO_PHONE='Y') order by te.is_view asc,  t.create_time desc
    limit<![CDATA[
     #{startNum,jdbcType=DECIMAL},#{endNum,jdbcType=DECIMAL}]]>
  </select>
  
  
  
  <select id="selectByCount" resultType="int" parameterType="java.lang.String" >

   select count(*) from TOM_MESSAGES t,tom_message_employees te
    where t.message_id=te.message_id and te.emp_code=#{code,jdbcType=DECIMAL} and (t.SEND_TO_APP='Y' or t.SEND_TO_EMAIL='Y' or  t.SEND_TO_PHONE='Y')
  </select>
  
  
  
  
  <select id="selectByMany" resultMap="BaseResultMap" parameterType="map" >

    select t.* from TOM_MESSAGES t
    where 1=1 and message_type=1
    <if test="name!=null"> 
			and INSTR(message_title,#{name,jdbcType=VARCHAR})>0
		</if> order by CREATE_TIME desc 
    limit<![CDATA[
    #{startNum,jdbcType=DECIMAL},#{endNum,jdbcType=DECIMAL}]]>
  </select>
  
   <select id="countByExample" resultType="int" parameterType="map" >
select count(*) from TOM_MESSAGES 
    where 1=1 and message_type=1
    <if test="name!=null">
			and INSTR(message_title,#{name,jdbcType=VARCHAR})>0 
		</if>
  </select>
</mapper>