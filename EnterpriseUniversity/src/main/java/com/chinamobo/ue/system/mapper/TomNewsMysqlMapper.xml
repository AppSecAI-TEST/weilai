<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.chinamobo.ue.system.dao.TomNewsMapper" >
  <resultMap id="BaseResultMap" type="com.chinamobo.ue.system.entity.TomNews" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    <id column="NEWS_ID" property="newsId" jdbcType="DECIMAL" />
    <result column="CREATOR_ID" property="creatorId" jdbcType="VARCHAR" />
    <result column="NEWS_TITLE" property="newsTitle" jdbcType="VARCHAR" />
    <result column="NEWS_PICTURE" property="newsPicture" jdbcType="VARCHAR" />
    <result column="PK_ORG" property="pkOrg" jdbcType="VARCHAR" />
    <result column="RELEASE_TIME" property="releaseTime" jdbcType="TIMESTAMP" />
    <result column="VIEW_COUNT" property="viewCount" jdbcType="DECIMAL" />
    <result column="IS_RELEASE" property="isRelease" jdbcType="VARCHAR" />
    <result column="ADMINS" property="admins" jdbcType="VARCHAR" />
    <result column="CREATER" property="creater" jdbcType="VARCHAR" />
    <result column="CREATE_TIME" property="createTime" jdbcType="TIMESTAMP" />
    <result column="OPERATOR" property="operator" jdbcType="VARCHAR" />
    <result column="UPDATE_TIME" property="updateTime" jdbcType="TIMESTAMP" />
    <result column="NEWS_DETAILS" property="newsDetails" jdbcType="CLOB" />
    <result column="RELEASER" property="releaser" jdbcType="VARCHAR" />
    
    
  </resultMap>
  <resultMap id="ResultMapWithBLOBs" type="com.chinamobo.ue.system.entity.TomNews" extends="BaseResultMap" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    <result column="NEWS_DETAILS" property="newsDetails" jdbcType="CLOB" />
  </resultMap>
  <sql id="Base_Column_List" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    NEWS_ID,CREATOR_ID, NEWS_TITLE, NEWS_PICTURE, PK_ORG, RELEASE_TIME, VIEW_COUNT, IS_RELEASE, 
    ADMINS, CREATER, CREATE_TIME, OPERATOR, UPDATE_TIME,NEWS_DETAILS,RELEASER
  </sql>
  <sql id="Blob_Column_List" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    NEWS_DETAILS
  </sql>
  <!-- <sql id='NEWS_SEQ'>NEWS_SEQ.nextval</sql> -->
  <select id="selectByPrimaryKey" resultMap="ResultMapWithBLOBs" parameterType="java.lang.Integer" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    select 
    <include refid="Base_Column_List" />
    ,
    <include refid="Blob_Column_List" />
    from TOM_NEWS
    where NEWS_ID = #{newsId,jdbcType=DECIMAL}
  </select>
  <delete id="deleteByPrimaryKey" parameterType="java.lang.Integer" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    delete from TOM_NEWS
    where NEWS_ID = #{newsId,jdbcType=DECIMAL}
  </delete>
  <insert id="insert" useGeneratedKeys="true" keyProperty="newsId" parameterType="com.chinamobo.ue.system.entity.TomNews" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
   <!--  <selectKey keyProperty="newsId" resultType="Integer" order="BEFORE">
			select
			<include refid="NEWS_SEQ" />
			from dual
		</selectKey> -->
    insert into TOM_NEWS (<!-- NEWS_ID, -->CREATOR_ID,NEWS_TITLE, NEWS_PICTURE, 
      PK_ORG, RELEASE_TIME, VIEW_COUNT, 
      IS_RELEASE, ADMINS, CREATER,
      CREATE_TIME, OPERATOR, UPDATE_TIME, 
      NEWS_DETAILS,RELEASER)
    values (<!-- #{newsId,jdbcType=DECIMAL}, -->#{creatorId,jdbcType=VARCHAR}, #{newsTitle,jdbcType=VARCHAR}, #{newsPicture,jdbcType=VARCHAR}, 
      #{pkOrg,jdbcType=VARCHAR}, #{releaseTime,jdbcType=TIMESTAMP}, #{viewCount,jdbcType=DECIMAL}, 
      #{isRelease,jdbcType=VARCHAR}, #{admins,jdbcType=VARCHAR}, #{creater,jdbcType=VARCHAR}, 
      #{createTime,jdbcType=TIMESTAMP}, #{operator,jdbcType=VARCHAR}, #{updateTime,jdbcType=TIMESTAMP}, 
      #{newsDetails,jdbcType=CLOB},#{releaser,jdbcType=VARCHAR})
  </insert>
  <insert id="insertSelective" useGeneratedKeys="true" keyProperty="newsId" parameterType="com.chinamobo.ue.system.entity.TomNews" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    insert into TOM_NEWS
    <trim prefix="(" suffix=")" suffixOverrides="," >
    	<!-- <if test="newsId != null" >
        NEWS_ID,
      </if> -->
      <if test="creatorId != null" >
        CREATOR_ID,
      </if>
      <if test="newsTitle != null" >
        NEWS_TITLE,
      </if>
      <if test="newsPicture != null" >
        NEWS_PICTURE,
      </if>
      <if test="pkOrg != null" >
        PK_ORG,
      </if>
      <if test="releaseTime != null" >
        RELEASE_TIME,
      </if>
      <if test="viewCount != null" >
        VIEW_COUNT,
      </if>
      <if test="isRelease != null" >
        IS_RELEASE,
      </if>
      <if test="adminis != null" >
        ADMINS,
      </if>
      <if test="creater != null" >
        CREATER,
      </if>
      <if test="createTime != null" >
        CREATE_TIME,
      </if>
      <if test="operator != null" >
        OPERATOR,
      </if>
      <if test="updateTime != null" >
        UPDATE_TIME,
      </if>
      <if test="newsDetails != null" >
        NEWS_DETAILS,
      </if>
      <if test="releaser != null" >
        RELEASER,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides="," >
      <!-- <if test="newsId != null" >
        #{newsId,jdbcType=DECIMAL},
      </if> -->
      <if test="creatorId != null" >
        #{creatorId,jdbcType=VARCHAR},
      </if>
      <if test="newsTitle != null" >
        #{newsTitle,jdbcType=VARCHAR},
      </if>
      <if test="newsPicture != null" >
        #{newsPicture,jdbcType=VARCHAR},
      </if>
      <if test="pkOrg != null" >
        #{pkOrg,jdbcType=VARCHAR},
      </if>
      <if test="releaseTime != null" >
        #{releaseTime,jdbcType=TIMESTAMP},
      </if>
      <if test="viewCount != null" >
        #{viewCount,jdbcType=DECIMAL},
      </if>
      <if test="isRelease != null" >
        #{isRelease,jdbcType=VARCHAR},
      </if>
      <if test="admins != null" >
        #{admins,jdbcType=VARCHAR},
      </if>
      <if test="creater != null" >
        #{creater,jdbcType=VARCHAR},
      </if>
      <if test="createTime != null" >
        #{createTime,jdbcType=TIMESTAMP},
      </if>
      <if test="operator != null" >
        #{operator,jdbcType=VARCHAR},
      </if>
      <if test="updateTime != null" >
        #{updateTime,jdbcType=TIMESTAMP},
      </if>
      <if test="newsDetails != null" >
        #{newsDetails,jdbcType=CLOB},
      </if>
      <if test="releaser!=null">
        #{releaser,jdbcType=VARCHAR},
      </if>
    </trim>
  </insert>
  <update id="updateByPrimaryKeySelective" parameterType="com.chinamobo.ue.system.entity.TomNews" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    update TOM_NEWS
    <set >
      <if test="newsTitle != null" >
        NEWS_TITLE = #{newsTitle,jdbcType=VARCHAR},
      </if>
      <if test="newsPicture != null" >
        NEWS_PICTURE = #{newsPicture,jdbcType=VARCHAR},
      </if>
      <if test="pkOrg != null" >
        PK_ORG = #{pkOrg,jdbcType=VARCHAR},
      </if>
      <if test="releaseTime != null" >
        RELEASE_TIME = #{releaseTime,jdbcType=TIMESTAMP},
      </if>
      <if test="viewCount != null" >
        VIEW_COUNT = #{viewCount,jdbcType=DECIMAL},
      </if>
      <if test="isRelease != null" >
        IS_RELEASE = #{isRelease,jdbcType=VARCHAR},
      </if>
      <if test="admins != null" >
        ADMINS = #{admins,jdbcType=VARCHAR},
      </if>
      <if test="creater != null" >
        CREATER = #{creater,jdbcType=VARCHAR},
      </if>
      <if test="createTime != null" >
        CREATE_TIME = #{createTime,jdbcType=TIMESTAMP},
      </if>
      <if test="operator != null" >
        OPERATOR = #{operator,jdbcType=VARCHAR},
      </if>
      <if test="updateTime != null" >
        UPDATE_TIME = #{updateTime,jdbcType=TIMESTAMP},
      </if>
      <if test="newsDetails != null" >
        NEWS_DETAILS = #{newsDetails,jdbcType=CLOB},
      </if>
      <if test="releaser!=null">
       RELEASER=#{releaser,jdbcType=VARCHAR},
      </if>
    </set>
    where NEWS_ID = #{newsId,jdbcType=DECIMAL}
  </update>
  <update id="updateByPrimaryKeyWithBLOBs" parameterType="com.chinamobo.ue.system.entity.TomNews" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    update TOM_NEWS
    set NEWS_TITLE = #{newsTitle,jdbcType=VARCHAR},
      NEWS_PICTURE = #{newsPicture,jdbcType=VARCHAR},
      PK_ORG = #{pkOrg,jdbcType=VARCHAR},
      RELEASE_TIME = #{releaseTime,jdbcType=TIMESTAMP},
      VIEW_COUNT = #{viewCount,jdbcType=DECIMAL},
      IS_RELEASE = #{isRelease,jdbcType=VARCHAR},
      ADMINS = #{admins,jdbcType=VARCHAR},
      CREATER = #{creater,jdbcType=VARCHAR},
      <if test="createTime != null" >
        CREATE_TIME = #{createTime,jdbcType=TIMESTAMP},
      </if>
      OPERATOR = #{operator,jdbcType=VARCHAR},
      UPDATE_TIME = #{updateTime,jdbcType=TIMESTAMP},
      NEWS_DETAILS = #{newsDetails,jdbcType=CLOB},
      RELEASER=#{releaser,jdbcType=VARCHAR}
    where NEWS_ID = #{newsId,jdbcType=DECIMAL}
  </update>
  <update id="updateByPrimaryKey" parameterType="com.chinamobo.ue.system.entity.TomNews" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    update TOM_NEWS
    set NEWS_TITLE = #{newsTitle,jdbcType=VARCHAR},
      NEWS_PICTURE = #{newsPicture,jdbcType=VARCHAR},
      PK_ORG = #{pkOrg,jdbcType=VARCHAR},
      RELEASE_TIME = #{releaseTime,jdbcType=TIMESTAMP},
      VIEW_COUNT = #{viewCount,jdbcType=DECIMAL},
      IS_RELEASE = #{isRelease,jdbcType=VARCHAR},
      ADMINS = #{admins,jdbcType=VARCHAR},
      CREATER = #{creater,jdbcType=VARCHAR},
      CREATE_TIME = #{createTime,jdbcType=TIMESTAMP},
      OPERATOR = #{operator,jdbcType=VARCHAR},
      UPDATE_TIME = #{updateTime,jdbcType=TIMESTAMP},
      RELEASER=#{releaser,jdbcType=VARCHAR},
    where NEWS_ID = #{newsId,jdbcType=DECIMAL}
  </update>
  
  <!-- 查询总数 -->
	<select id="countByExample" resultType="int" parameterType="map">
		SELECT count(*)
    FROM
  TOM_NEWS  where IS_RELEASE='Y'
		<if test="orgCode!= null">
		and pk_org =#{orgCode,jdbcType=VARCHAR}
		</if>
	</select>
	<!--分页查询 -->
	<select id="selectByMany" resultType="com.chinamobo.ue.api.myInfo.dto.NewsDto"
		parameterType="map">
		select  C.NEWS_ID as newsId,C.NEWS_TITLE as newsTitle,C.NEWS_PICTURE as newsPicture,C.RELEASE_TIME as releaseTime,J.IS_VIEW as isView from (select  n.* from tom_news n where  n.pk_org=#{orgCode,jdbcType=VARCHAR}
		 and n.is_release='Y' )C left join 
		  (select  ne.* from  tom_news_employees ne where  ne.code=#{code,jdbcType=VARCHAR})J on C.news_Id=J.news_Id order by J.IS_VIEW desc ,C.RELEASE_TIME desc
    limit<![CDATA[
    #{startNum,jdbcType=DECIMAL},#{endNum,jdbcType=DECIMAL}]]> 
	</select>
	
	<select id="selectByOne" resultMap="BaseResultMap"
		parameterType="map">
	SELECT *
		FROM
		tom_news  where  pk_org =#{orgCode,jdbcType=VARCHAR} and NEWS_ID=#{newsId,jdbcType=VARCHAR}
	</select>
	<!-- 分页模糊查询咨询条数和列表 --> 
	<select id="selectBycount" resultType="int" parameterType="map">
	 SELECT count(*) from TOM_NEWS
	 where INSTR(NEWS_TITLE,#{newsTitle,jdbcType=VARCHAR})>0 
	</select>
	<select id ="selectByList" resultMap="BaseResultMap" parameterType="map">
	SELECT
	NEWS_ID AS newsId,
	NEWS_TITLE AS newsTitle,
	RELEASE_TIME AS releaseTime,
	ADMINS AS admins,
	VIEW_COUNT AS viewCount,
	CREATER AS creater,
	OPERATOR AS OPERATOR,
	UPDATE_TIME AS updateTime,
	RELEASER AS releaser,
	IS_RELEASE AS isRelease
FROM
	TOM_NEWS
where INSTR(NEWS_TITLE,#{newsTitle,jdbcType=VARCHAR})>0
  order by UPDATE_TIME desc
		limit<![CDATA[#{startNum,jdbcType=DECIMAL},#{endNum,jdbcType=DECIMAL}]]> 
	</select>
	
	<select id="selectBycountForRooling" resultType="int" parameterType="map">
	 SELECT count(*) from TOM_NEWS
	 WHERE is_release='Y' and INSTR(NEWS_TITLE,#{newsTitle,jdbcType=VARCHAR})>0 
	 
	</select>
	
	
	<select id ="selectByListForRoolling" resultMap="BaseResultMap" parameterType="map">
   SELECT
	NEWS_ID AS newsId,
	NEWS_TITLE AS newsTitle,
	RELEASE_TIME AS releaseTime,
	ADMINS AS admins,
	VIEW_COUNT AS viewCount,
	CREATER AS creater,
	OPERATOR AS OPERATOR,
	UPDATE_TIME AS updateTime,
	RELEASER AS releaser,
	IS_RELEASE AS isRelease
FROM
	TOM_NEWS
WHERE is_release='Y' 
<if test="newsTitle!=null ">
and INSTR(NEWS_TITLE,#{newsTitle,jdbcType=VARCHAR})>0
	</if>
 order by  UPDATE_TIME desc 
		limit<![CDATA[#{startNum,jdbcType=DECIMAL},#{endNum,jdbcType=DECIMAL}]]> 
	</select>
	
	
	<select id="selectByReleaser" resultMap="BaseResultMap"  parameterType="map">
	SELECT
	IS_RELEASE AS isRelease
FROM
	TOM_NEWS
	where 1=1
	<if test="newsId!=null ">
	and NEWS_ID = #{newsId,jdbcType=DECIMAL}
	</if>
	</select> 
	<select id="selectById" resultType="com.chinamobo.ue.system.entity.TomNews" parameterType="java.lang.Integer">
	SELECT
	NEWS_ID AS newsId,
	NEWS_TITLE AS newsTitle,
	NEWS_PICTURE AS newsPicture,
    NEWS_DETAILS AS newsDetails,
	RELEASE_TIME AS releaseTime,
	VIEW_COUNT AS viewCount,
	CREATER AS creater,
	PK_ORG as pkOrg,
	ADMINS AS admins,
	OPERATOR AS OPERATOR,
	UPDATE_TIME AS updateTime,
    RELEASER AS releaser,	
	IS_RELEASE AS isRelease
FROM
	TOM_NEWS
	where NEWS_ID=#{newsId,jdbcType=DECIMAL}
	</select>
</mapper>