<meta charset="UTF-8" >
<!-- 学员报表-学习资源详情（课程） -->
<div class="container-fluid overflow-auto view-report" id="page" ng-controller="EmpLearningDetailedCourseController">
	<div class="row">
		<div class="container-fluid top-func-bar">
			<div class="row">
				<div class="col-xs-12">
					<form role="search" class="">
						<div class="row">
							<div class="col-xs-3">
								<div class="input-group" ng-class="{'has-error':courseName.length>=20}">
									<input type="text"  placeholder="请输入资源名称"  class="form-control " ng-model="courseName" maxlength="20" ng-keydown='autoSearch($event)'>
									<span class="input-group-btn">
	                                	<a  class="btn  btn-primary" ng-click="search()">搜索</a>
	                                </span>
								</div>
							</div>
							<div class="col-xs-3">
								<div class="input-group" ng-class="{'has-error':activityName.length>=20}">
									<input type="text"  placeholder="请输入活动名称名称"  class="form-control " ng-model="activityName" maxlength="20" ng-keydown='autoSearch($event)'>
									<span class="input-group-btn">
	                                	<a  class="btn  btn-primary" ng-click="search()">搜索</a>
	                                </span>
								</div>
							</div>
						</div>
						<div class="row"  style="margin-top: 15px;">
							<div class="col-xs-5" >
								<label>完成时间:</label>
								<div style="display:inline-block;margin-left:15px;width:340px;">
							 		<input class="Wdate form-control width_5"  id="examTotalTime"   onchange="" name="examTotalTime"  type="text"  ng-model="examTotalTime"
				             	 			onFocus="WdatePicker({startDate:'%y-%M-%d 00:00:00',lang:'zh-cn',dateFmt:'yyyy-MM-dd HH:mm:ss'})" readonly>
				             	 	<a class="btn  btn-primary pull-right" ng-click="searchData()">查询</a>
				             	 	<a class="btn  btn-default pull-right" ng-click="reSetSearchOption()">重置</a>
						 		</div>
						 		<a class="btn  btn-primary pull-right"  type="checkbox"  name="arayacak"  ng-checked="a.arayacak=='Y'"  ng-click="advancedSearch()">高级搜索</a>
							</div>
						</div>
						<div class="row" style="margin-top: 15px;" ng-show="a.arayacak=='Y'" >
							<div class="col-xs-2">
								<div class="input-group" ng-class="{'has-error':code.length>=20}">
									<input type="text"  placeholder="请输入用户名"  class="form-control " ng-model="code" maxlength="20" ng-keydown='autoSearch($event)'>
									<span class="input-group-btn">
										<a  class="btn  btn-primary" ng-click="search()">搜索</a>
									</span>
								</div>
							</div>
							<div class="col-xs-2">
								<div class="input-group" ng-class="{'has-error':name.length>=20}">
									<input type="text"  placeholder="请输入姓名"  class="form-control " ng-model="name" maxlength="20" ng-keydown='autoSearch($event)'>
									<span class="input-group-btn">
										<a  class="btn  btn-primary" ng-click="search()">搜索</a>
									</span>
								</div>
							</div>
						</div>
						<div class="row" style="margin-top: 15px;" ng-show="a.arayacak=='Y'" >
							<div class="col-xs-2">
								<select style="line-height: 28px;" class="form-control" ng-model="parentClassifyId" ng-change="changeSeclectOption5()" ng-options=" x.projectId as x.projectName for x in method5">
									<option value="" >活动分类</option>
								</select>
							</div>
							<!-- <div class="col-xs-1">
								<select style="line-height: 28px;" class="form-control" ng-model="activityId" ng-change="changeSeclectOption6()" ng-options=" x.activityId as x.activityName for x in method6">
									<option value="" >活动名称</option>
								</select>
							</div> -->
							<div class="col-xs-2">
								<select style="line-height: 28px;" class="form-control" ng-model="activityState"  ng-change="changeSeclectOption()" ng-options="x.value as x.name for x in activityIn">
									<option value="" >活动状态</option>
								</select>
							</div>
							<div class="col-xs-2">
								<select style="line-height: 28px;" class="form-control" ng-model="needApply"  ng-change="changeSeclectOption()" ng-options="x.value as x.name for x in needApplyIn">
									<option value="" >活动性质</option>
								</select>
							</div>
						</div>
						<div class="row" style="margin-top: 15px;" ng-show="a.arayacak=='Y'" >
							<div class="col-xs-2">
								<select style="line-height: 28px;" class="form-control" ng-model="courseOnline" ng-change="changeSeclectOption7()" ng-options=" x.value as x.name for x in method7">
									<option value="" >资源一级类别</option>
								</select>
							</div>
							<div class="col-xs-2">
								<select style="line-height: 28px;" class="form-control" ng-model="sectionClassifyName" ng-change="changeSeclectOption8()" ng-options=" x.sectionClassifyCode as x.sectionClassifyName for x in method8">
									<option value="" >资源二级类别</option>
								</select>
							</div>
							<div class="col-xs-2">
								<select style="line-height: 28px;" class="form-control" ng-model="openCourse"  ng-change="changeSeclectOption9()" ng-options="x.value as x.name for x in method9">
									<option value="" >资源属性</option>
								</select>
							</div>
						</div>
						<div class="row" style="margin-top: 15px;" ng-show="a.arayacak=='Y'" >
							<div class="col-xs-2">
								<select style="line-height: 28px;" class="form-control" ng-model="orgName" ng-change="changeSeclectOption1()" ng-options=" x.code as x.name for x in method1">
									<option value="" >所属组织</option>
								</select>
							</div>
							<div class="col-xs-2">
								<select style="line-height: 28px;" class="form-control" ng-model="oneDeptName" ng-change="changeSeclectOption2()" ng-options=" x.code as x.firstName for x in method2">
									<option value="" >一级部门</option>
								</select>
							</div>
							<div class="col-xs-2">
								<select style="line-height: 28px;" class="form-control" ng-model="twoDeptName" ng-change="changeSeclectOption3()" ng-options=" x.code as x.secondName for x in method3">
									<option value="" >二级部门</option>
								</select>
							</div>
							<div class="col-xs-2">
								<select style="line-height: 28px;" class="form-control" ng-model="threeDeptName" ng-change="changeSeclectOption4()" ng-options=" x.code as x.thirdName for x in method4">
									<option value="" >三级部门</option>
								</select>
							</div>
						</div>
					</form>
				</div>
			</div>
		</div>
		<div class="container-fluid">
			<table class="table table-striped table-bordered table-hover table-condensed">
				<thead>
				    <tr>
						<td colspan="10" class="col-xs-2" align="center">用户信息</td>
						<td colspan="6" class="col-xs-2" align="center">资源信息</td>
						<td colspan="10" class="col-xs-2" align="center">所属活动信息</td>
						<td colspan="5" class="col-xs-2" align="center">资源信息-线上课程</td>
						<td colspan="6" class="col-xs-2" align="center">资源信息-线下班次</td>
						<td colspan="9" class="col-xs-2" align="center">资源评分和评论统计</td>
					</tr> 
				
					<tr >
						<th class="min-width1">序号</th>
						<th class="min-width1">用户名</th>
						<th class="min-width1">姓名</th>
						<th class="min-width1">所属组织</th>
						<th class="min-width1">一级部门</th>
						<th class="min-width1">二级部门</th>
						<th class="min-width1">三级部门</th>
						
						<th class="min-width1">邮箱</th>
						<th class="min-width1">管理角色分配</th>
						
						<th class="min-width1">资源名称</th>
						<th class="min-width1">资源编号</th>
						<th class="min-width1">资源积分</th>
						<th class="min-width1">资源属性</th>
						<th class="min-width1">资源类别1级</th>
						<th class="min-width1">资源类别2级</th>
						
						<th class="min-width1">所属活动名称</th>
						<th class="min-width1">项目名称</th>
						<th class="min-width1">活动编号</th>
						<th class="min-width1">创建日期</th>
						<th class="min-width1">活动性质</th>
						<th class="min-width1">活动报名</th>
						<th class="min-width1">活动报名时间</th>
						<th class="min-width1">活动开始时间</th>
						<th class="min-width1">活动结束时间</th>
						<th class="min-width1">授权日期</th>
						
						<th class="min-width1">首次访问时间</th>
						<th class="min-width1">学习次数</th>
						<th class="min-width1">学习资源时长</th>
						<th class="min-width1">学习时长</th>
						<th class="min-width1">学习进度</th>
						
<!-- 						<th class="min-width1">线下报名</th> -->
						<th class="min-width1">线下班次名称</th>
<!-- 						<th class="min-width1">线下班次时间</th> -->
						<th class="min-width1">线下班次地点</th>
						<th class="min-width1">线下班次报名时间</th>
						<th class="min-width1">线下班次开始时间</th>
						<th class="min-width1">线下班次结束时间</th>
						<th class="min-width1">班次签到</th>
						
<!-- 						<th class="min-width1">评分</th> -->
						<th class="min-width1">评分时间</th>
						<th class="min-width1">评分维度1</th>
						<th class="min-width1">评分维度2</th>
						<th class="min-width1">评分维度3</th>
						<th class="min-width1">评分维度4</th>
						<th class="min-width1">评分维度5</th>
						<th class="min-width1">评论内容</th>
						<th class="min-width1">是否收藏</th>
						<th class="min-width1">是否点赞</th>
						
					</tr>
				</thead>
				<tbody>
					<tr ng-repeat="a in page.data" ng-class="{'current-focus-tr':a.checked}" ng-click="highLightCurrRow1(a)" style="cursor:pointer;">
						<td ng-bind="$index+1"></td>
						<td ng-bind="a.code"></td>
						<td ng-bind="a.name"></td>
						<td ng-bind="a.orgName"></td>
						<td ng-bind="a.oneDeptName"></td>
						<td ng-bind="a.twoDeptName"></td>
						<td ng-bind="a.threeDeptName"></td>
						
						<td ng-bind="a.secretEmail"></td>
						<td ng-bind="a.isAdmin"></td>
						
						<td ng-bind="a.courseName"></td>
						<td ng-bind="a.courseNumber"></td>
						<td ng-bind="a.ecurrency"></td>
						<td ng-bind="a.openCourse=='N'?'非公开课':'公开课'"></td>
						<td ng-bind="a.courseOnline=='N'?'线下':'线上'"></td>
						<td ng-bind="a.sectionClassifyName"></td>
						
						<td ng-bind="a.activityName"></td>
						<td ng-bind="a.parentProjectClassifyName"></td>
						<td ng-bind="a.activityNumber"></td>
						<td ng-bind="a.createTime | date:'yyyy-MM-dd HH:mm:ss'"></td>
						<td><span ng-if="a.needApply=='Y'">选修</span><span ng-if="a.needApply=='N'">必修</span></td>
						<td><span ng-if="a.needApply=='Y'">是</span><span ng-if="a.needApply=='N'">否</span></td>
						<td ng-bind="a.applicationStartTime | date:'yyyy-MM-dd HH:mm:ss'"></td>
						<td ng-bind="a.activityStartTime | date:'yyyy-MM-dd HH:mm:ss'"></td>
						<td ng-bind="a.activityEndTime | date:'yyyy-MM-dd HH:mm:ss'"></td>
						<td ng-bind="a.updateTime | date:'yyyy-MM-dd HH:mm:ss'"></td>
<!-- 						<td ng-bind="a.classesIsSign"></td> -->
						
						<td ng-bind="a.firstVisitTime | date:'yyyy-MM-dd HH:mm:ss'"></td>
						<td ng-bind="a.learningCount"></td>
						<td ng-bind="a.courseTimes"></td>
						<td ng-bind="a.learningCourseTimes"></td>
						<td ng-bind="a.learningrate"></td>
						
<!-- 						<td ng-bind="a.classesSignUp"></td> -->
						<td ng-bind="a.classesName"></td>
<!-- 						<td ng-bind="a.classesTime | date:'yyyy-MM-dd HH:mm:ss'"></td> -->
						<td ng-bind="a.classesAddress"></td>
						<td ng-bind="a.classesSignUpTime | date:'yyyy-MM-dd HH:mm:ss'"></td>
						<td ng-bind="a.classesBeginTime | date:'yyyy-MM-dd HH:mm:ss'"></td>
						<td ng-bind="a.classesEndTime | date:'yyyy-MM-dd HH:mm:ss'"></td>
<!-- 						<td ng-bind="a.classesSignTime | date:'yyyy-MM-dd HH:mm:ss'"></td> -->
						<td ng-bind="a.classesIsSign"></td>
						
<!-- 						<td ng-bind="a.score"></td> -->
						<td ng-bind="a.commentDate | date:'yyyy-MM-dd HH:mm:ss'"></td>
						<td ng-bind="a.courseGradeDimensionsC1"></td>
						<td ng-bind="a.courseGradeDimensionsC2"></td>
						<td ng-bind="a.courseGradeDimensionsC3"></td>
						<td ng-bind="a.courseGradeDimensionsC4"></td>
						<td ng-bind="a.courseGradeDimensionsC5"></td>
						<td ng-bind="a.oneCourseCommentContent"></td>
<!-- 						<td><span ng-show="a.favoriteStatus=='Y'" ng-bind="'收藏'" ><span ng-show="a.favoriteStatus=='N'" ng-bind="'取消收藏'" ></td> -->
						<td ng-bind="a.favoriteStatus=='Y'?'是':'否'"></td>
						<td ng-bind="a.thumbUpStatus=='Y'?'是':'否'"></td>
<!-- 						<td><span ng-show="a.thumbUpStatus=='Y'" ng-bind="'点赞'" ><span ng-show="a.thumbUpStatus=='N'" ng-bind="'取消收藏'" ></td> -->
					</tr>
				</tbody>
			</table>
			<div class="form-group">
		 		<p class="row">&nbsp;&nbsp;&nbsp;&nbsp;选择导出模块：全选 <input type="checkbox" ng-checked="allIsChecked"  ng-click="toggleCheckAllColumn()"></p>
	            <div class="container-fluid" style="margin-left:20px;">
	            	<div class="row">
	            		<label class="checkbox-inline checkbox-control" ng-repeat="column in queryColumns">
		                    <input type="checkbox" ng-checked="column.checked"  ng-click="toggleColumnChecked(column)" value="{{column.value}}">{{column.name}}
		                </label>
		          	</div>
	            </div> 
		 	</div>
			<div class="container-fluid" style="margin-top:20px;" ng-if="page.data.length>0">
				<div class="row">
					<!-- <span class="batch-remove-selectAll" ng-click="chooseCurrPageAllItem()">
						&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<input type="checkbox"  ng-checked="selectAll">全选
					</span> -->
					<a class="btn btn-primary" ng-click="downloadEmpLearningDeCourseExcel()">导&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;出 </a>
				</div>
			</div>
			<div>
				<div class="container-fluid" pagination conf="paginationConf"></div>
			</div>
		</div>
	</div>
</div>
<script type="text/javascript">
	//监听窗口大小变化，自适应高度
	$(document).ready(function () {
		resizeView();
	});
</script>